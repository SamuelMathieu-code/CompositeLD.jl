<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>CompositeLD.jl Documentation · CompositeLD.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">CompositeLD.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">CompositeLD.jl Documentation</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">CompositeLD.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">CompositeLD.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SamuelMathieu-code/CompositeLD.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="CompositeLD.jl-Documentation"><a class="docs-heading-anchor" href="#CompositeLD.jl-Documentation">CompositeLD.jl Documentation</a><a id="CompositeLD.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#CompositeLD.jl-Documentation" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>CompositeLD is a package using <a href="https://github.com/OpenMendel/SnpArrays.jl">SnpArrays</a> to perform some usefull calculations related LD. In particular :</p><ul><li>Calculate LD between two SNPs (given position or id in PLINK files)</li><li>Get the LD matrix of a group of SNPs</li><li>Get Strongly correlated SNPs to a given group of SNPs</li><li>Clumping given SNPs in a prioritized order.</li></ul><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><pre><code class="language-julia hljs">using SnpArrays
using CompositeLD

data = SnpData(SnpArrays.datadir(datapath))

ld = ld_r2(&quot;rs1234&quot;, &quot;rs654321&quot;, data)

ld_mat = getLDmat(data, [(1, 459876), (1, 58735), (2, 97654)])

strong = getStrongLD(data, [&quot;rs1234&quot;, &quot;rs5678&quot;])

kept_v_b = clump(data, [(1, 459876), (1, 58735), (2, 97654)])</code></pre><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="index.html#CompositeLD.jl-Documentation">CompositeLD.jl Documentation</a></li><li class="no-marker"><ul><li><a href="index.html#Overview">Overview</a></li><li><a href="index.html#Example">Example</a></li><li><a href="index.html#Contents">Contents</a></li><li><a href="index.html#Functions">Functions</a></li><li><a href="index.html#Index">Index</a></li></ul></li></ul><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="CompositeLD.formatSnpData!" href="#CompositeLD.formatSnpData!"><code>CompositeLD.formatSnpData!</code></a> — <span class="docstring-category">Function</span></header><section><div><p>format Genotype information contained in SnpData for snp sorted search based on chromosome and position (snpid). Adds a column chr<em>pos (chr::Int8, pos::Int) in snp</em>info and sorts snp<em>info by chr</em>pos (snpid). Adds a column containing original indices.     returns nothing</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ref = SnpData(datadir(&quot;some/data&quot;))

formatSnpData!(ref, :chr_pos)

formatSnpData!(ref, :snpid)</code></pre><p>Note this function does not take into account the user might want to write SnpData in bed, bim, fam format.      The changes done by this function can and will cause problems if writing plink files after calling <code>formatSnpData!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SamuelMathieu-code/CompositeLD.jl/blob/73b3722392b7456cb596fdd594dfc4d04f4cb7aa/src/ld.jl#L333-L350">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeLD.ld_r2" href="#CompositeLD.ld_r2"><code>CompositeLD.ld_r2</code></a> — <span class="docstring-category">Function</span></header><section><div><p>LD r² composite of pair of SNPs given genotype matrix and indices of snps in matrix</p><p><strong>Examples :</strong></p><pre><code class="language-julia hljs">ref = SnpData(datadir(&quot;some/data&quot;))

ld_r2([0x00, 0x01, 0x03], [0x00, 0x00, 0x03])

ld_r2(1, 2, ref.snparray)

formatSnpData!(ref, :snpid)

ld_r2(&quot;rs123&quot;, &quot;rs456&quot;, ref, formated = true)

ld_r2((1, 234), (1, 567), ref)</code></pre><p>If formatSnpData has already been called on good snp info type (<code>:chr_pos</code> or <code>:snpid</code>), <code>formated = true</code> option does not verify or modify formating. See <a href="index.html#CompositeLD.formatSnpData!"><code>formatSnpData!</code></a>. <br/>returns a Float64</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SamuelMathieu-code/CompositeLD.jl/blob/73b3722392b7456cb596fdd594dfc4d04f4cb7aa/src/ld.jl#L104-L125">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeLD.getLDmat" href="#CompositeLD.getLDmat"><code>CompositeLD.getLDmat</code></a> — <span class="docstring-category">Function</span></header><section><div><p>LD r² composite matrix of n SNPs from index in given SnpArray</p><p><strong>Examples :</strong></p><pre><code class="language-julia hljs">ref = SnpData(datadir(&quot;some/data&quot;))

M::Matrix{Float64} = getLDmat([2, 4, 8, 16], ref.snparray)

getLDmat([(1, 123), (1, 456), (1, 789)], ref)

formatSnpData!(ref, :snpid)

M::Matrix{Float64} = getLDmat([&quot;rs123&quot;, &quot;rs456&quot;, &quot;rs789&quot;], ref, formated = true)</code></pre><p>If formatSnpData has already been called on good snp info type (<code>:chr_pos</code> or <code>:snpid</code>), <code>formated = true</code> option does not verify or modify formating. See <a href="index.html#CompositeLD.formatSnpData!"><code>formatSnpData!</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SamuelMathieu-code/CompositeLD.jl/blob/73b3722392b7456cb596fdd594dfc4d04f4cb7aa/src/ld.jl#L247-L266">source</a></section><section><div><p>Get correlation Matrix for specifies snps (tuple of the form (chr, pos)      given reference genotype SnpData.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SamuelMathieu-code/CompositeLD.jl/blob/73b3722392b7456cb596fdd594dfc4d04f4cb7aa/src/ld.jl#L277-L280">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeLD.getStrongLD" href="#CompositeLD.getStrongLD"><code>CompositeLD.getStrongLD</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Get strongly correlated variants from list.</p><p>arguments : </p><p><code>ref&amp;#95;genotypes::SnpData</code> : reference genotypes (formated by <a href="index.html#CompositeLD.formatSnpData!"><code>formatSnpData!</code></a> or not) <code>snps::Union{AbstractVector{&lt;:Tuple{integer, Integer}}, AbstractVector{&lt;:AbstractString}}</code> : snps for which to search proxis</p><p>options : </p><p><code>formated::Bool</code> : indicates if ref SnpData is already formated according to :chr_pos (chr, pos) or :snpid (id as string)<br/><code>window::Integer</code> : maximal distance from snip for ld calculations<br/><code>r2&amp;#95;tresh::AbstractFloat</code> : minimal r² for 2 snps to be considered strongly correlated.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ref = SnpData(datadir(&quot;some/data&quot;))

l::Vector{String} = getStrongLD([(1, 123), (1, 456), (1, 789)], ref, window = 250000)

formatSnpData!(ref, :snpid)

l::Vector{String} = getStrongLD([&quot;rs123&quot;, &quot;rs456&quot;, &quot;rs789&quot;], ref, formated = true, r2_tresh = 0.9)</code></pre><p>If formatSnpData has already been called on good snp info type (<code>:chr_pos</code> or <code>:snpid</code>), <code>formated = true</code> option does not verify or modify formating. See <a href="index.html#CompositeLD.formatSnpData!"><code>formatSnpData!</code></a>. <br/></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SamuelMathieu-code/CompositeLD.jl/blob/73b3722392b7456cb596fdd594dfc4d04f4cb7aa/src/getStrongLD.jl#L5-L33">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeLD.clump" href="#CompositeLD.clump"><code>CompositeLD.clump</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Implementation of the clumping algorithm prioritising first snps in given Vector and formated Genotypes SnpData (see formatSnpData!)     returns a vector of booean indication if each given snp is kept</p><p><strong>arguments :</strong></p><p><code>ref&amp;#95;genotypes::SnpData</code> : reference genotypes (formated by <a href="index.html#CompositeLD.formatSnpData!"><code>formatSnpData!</code></a> or not) <code>snps::Union{AbstractVector{&lt;:Tuple{integer, Integer}}, AbstractVector{&lt;:AbstractString}}</code> : snps to clump</p><p><strong>options :</strong> </p><p><code>formated::Bool</code> : indicates if ref SnpData is already formated according to :chr_pos (chr, pos) or :snpid (id as string)<br/><code>r2&amp;#95;tresh::AbstractFloat</code> : minimal r² for 2 snps to be considered strongly correlated.</p><p><strong>Examples :</strong></p><pre><code class="language-julia-repl hljs">julia&gt; ref = SnpData(datadir(&quot;some/data&quot;));

julia&gt; kept_v_b::Vector{Bool} = clump([(1, 123), (1, 456), (1, 789)], ref)
3-element Vector{Int64}:
 1
 0
 1

julia&gt; formatSnpData!(ref, :snpid);

julia&gt; kept_v_b::Vector{Bool} = clump([&quot;rs123&quot;, &quot;rs456&quot;, &quot;rs789&quot;], ref, formated = true)
3-element Vector{Int64}:
 1
 0
 1</code></pre><p>If formatSnpData has already been called on good snp info type (<code>:chr_pos</code> or <code>:snpid</code>), <code>formated = true</code> option does not verify or modify formating. See <a href="index.html#CompositeLD.formatSnpData!"><code>formatSnpData!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SamuelMathieu-code/CompositeLD.jl/blob/73b3722392b7456cb596fdd594dfc4d04f4cb7aa/src/clump.jl#L4-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositeLD.tclump" href="#CompositeLD.tclump"><code>CompositeLD.tclump</code></a> — <span class="docstring-category">Function</span></header><section><div><p>threaded implementation of the clumping algorithm prioritising first snps in given Vector and formated Genotypes SnpData (see formatSnpData!)     returns a vector of booean indication if each given snp is kept</p><p><strong>arguments :</strong></p><p><code>ref&amp;#95;genotypes::SnpData</code> : reference genotypes (formated by <a href="index.html#CompositeLD.formatSnpData!"><code>formatSnpData!</code></a> or not) <code>snps::Union{AbstractVector{&lt;:Tuple{integer, Integer}}, AbstractVector{&lt;:AbstractString}}</code> : snps to clump</p><p><strong>options :</strong> </p><p><code>formated::Bool</code> : indicates if ref SnpData is already formated according to :chr_pos (chr, pos) or :snpid (id as string)<br/><code>r2&amp;#95;tresh::AbstractFloat</code> : minimal r² for 2 snps to be considered strongly correlated.</p><p><strong>Examples :</strong></p><pre><code class="language-julia hljs">ref = SnpData(datadir(&quot;some/data&quot;))

kept_v_b::Vector{Bool} = tclump([(1, 123), (1, 456), (1, 789)], ref)

formatSnpData!(ref, :snpid)

kept_v_b::Vector{Bool} = tclump([&quot;rs123&quot;, &quot;rs456&quot;, &quot;rs789&quot;], ref, formated = true)</code></pre><p>If formatSnpData has already been called on good snp info type (<code>:chr_pos</code> or <code>:snpid</code>), <code>formated = true</code> option does not verify or modify formating. See <a href="index.html#CompositeLD.formatSnpData!"><code>formatSnpData!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SamuelMathieu-code/CompositeLD.jl/blob/73b3722392b7456cb596fdd594dfc4d04f4cb7aa/src/clump.jl#L126-L155">source</a></section></article><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="index.html#CompositeLD.clump"><code>CompositeLD.clump</code></a></li><li><a href="index.html#CompositeLD.formatSnpData!"><code>CompositeLD.formatSnpData!</code></a></li><li><a href="index.html#CompositeLD.getLDmat"><code>CompositeLD.getLDmat</code></a></li><li><a href="index.html#CompositeLD.getStrongLD"><code>CompositeLD.getStrongLD</code></a></li><li><a href="index.html#CompositeLD.ld_r2"><code>CompositeLD.ld_r2</code></a></li><li><a href="index.html#CompositeLD.tclump"><code>CompositeLD.tclump</code></a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 11 July 2023 15:55">Tuesday 11 July 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
